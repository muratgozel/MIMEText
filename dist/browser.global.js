var MimeText = (function (exports) {
	'use strict';

	var G=Object.defineProperty;var Z=(n,e,t)=>e in n?G(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var o=(n,e,t)=>(Z(n,typeof e!="symbol"?e+"":e,t),t);var F="3.7.7",Y=F,f=typeof Buffer=="function",B=typeof TextDecoder=="function"?new TextDecoder:void 0,S=typeof TextEncoder=="function"?new TextEncoder:void 0,J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b=Array.prototype.slice.call(J),C=(n=>{let e={};return n.forEach((t,r)=>e[t]=r),e})(b),K=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,a=String.fromCharCode.bind(String),H=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):n=>new Uint8Array(Array.prototype.slice.call(n,0)),k=n=>n.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),U=n=>n.replace(/[^A-Za-z0-9\+\/]/g,""),R=n=>{let e,t,r,i,s="",d=n.length%3;for(let u=0;u<n.length;){if((t=n.charCodeAt(u++))>255||(r=n.charCodeAt(u++))>255||(i=n.charCodeAt(u++))>255)throw new TypeError("invalid character found");e=t<<16|r<<8|i,s+=b[e>>18&63]+b[e>>12&63]+b[e>>6&63]+b[e&63];}return d?s.slice(0,d-3)+"===".substring(d):s},w=typeof btoa=="function"?n=>btoa(n):f?n=>Buffer.from(n,"binary").toString("base64"):R,v=f?n=>Buffer.from(n).toString("base64"):n=>{let t=[];for(let r=0,i=n.length;r<i;r+=4096)t.push(a.apply(null,n.subarray(r,r+4096)));return w(t.join(""))},A=(n,e=!1)=>e?k(v(n)):v(n),Q=n=>{if(n.length<2){var e=n.charCodeAt(0);return e<128?n:e<2048?a(192|e>>>6)+a(128|e&63):a(224|e>>>12&15)+a(128|e>>>6&63)+a(128|e&63)}else {var e=65536+(n.charCodeAt(0)-55296)*1024+(n.charCodeAt(1)-56320);return a(240|e>>>18&7)+a(128|e>>>12&63)+a(128|e>>>6&63)+a(128|e&63)}},ee=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,$=n=>n.replace(ee,Q),_=f?n=>Buffer.from(n,"utf8").toString("base64"):S?n=>v(S.encode(n)):n=>w($(n)),h=(n,e=!1)=>e?k(_(n)):_(n),D=n=>h(n,!0),te=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,ne=n=>{switch(n.length){case 4:var e=(7&n.charCodeAt(0))<<18|(63&n.charCodeAt(1))<<12|(63&n.charCodeAt(2))<<6|63&n.charCodeAt(3),t=e-65536;return a((t>>>10)+55296)+a((t&1023)+56320);case 3:return a((15&n.charCodeAt(0))<<12|(63&n.charCodeAt(1))<<6|63&n.charCodeAt(2));default:return a((31&n.charCodeAt(0))<<6|63&n.charCodeAt(1))}},L=n=>n.replace(te,ne),V=n=>{if(n=n.replace(/\s+/g,""),!K.test(n))throw new TypeError("malformed base64.");n+="==".slice(2-(n.length&3));let e,t="",r,i;for(let s=0;s<n.length;)e=C[n.charAt(s++)]<<18|C[n.charAt(s++)]<<12|(r=C[n.charAt(s++)])<<6|(i=C[n.charAt(s++)]),t+=r===64?a(e>>16&255):i===64?a(e>>16&255,e>>8&255):a(e>>16&255,e>>8&255,e&255);return t},j=typeof atob=="function"?n=>atob(U(n)):f?n=>Buffer.from(n,"base64").toString("binary"):V,N=f?n=>H(Buffer.from(n,"base64")):n=>H(j(n).split("").map(e=>e.charCodeAt(0))),W=n=>N(X(n)),re=f?n=>Buffer.from(n,"base64").toString("utf8"):B?n=>B.decode(N(n)):n=>L(j(n)),X=n=>U(n.replace(/[-_]/g,e=>e=="-"?"+":"/")),I=n=>re(X(n)),ie=n=>{if(typeof n!="string")return !1;let e=n.replace(/\s+/g,"").replace(/={0,2}$/,"");return !/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},P=n=>({value:n,enumerable:!1,writable:!0,configurable:!0}),q=function(){let n=(e,t)=>Object.defineProperty(String.prototype,e,P(t));n("fromBase64",function(){return I(this)}),n("toBase64",function(e){return h(this,e)}),n("toBase64URI",function(){return h(this,!0)}),n("toBase64URL",function(){return h(this,!0)}),n("toUint8Array",function(){return W(this)});},z=function(){let n=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,P(t));n("toBase64",function(e){return A(this,e)}),n("toBase64URI",function(){return A(this,!0)}),n("toBase64URL",function(){return A(this,!0)});},se=()=>{q(),z();},O={version:F,VERSION:Y,atob:j,atobPolyfill:V,btoa:w,btoaPolyfill:R,fromBase64:I,toBase64:h,encode:h,encodeURI:D,encodeURL:D,utob:$,btou:L,decode:I,isValid:ie,fromUint8Array:A,toUint8Array:W,extendString:q,extendUint8Array:z,extendBuiltins:se};var l=class extends Error{constructor(t,r=""){super(r);o(this,"name","");o(this,"description","");this.name=t,this.description=r;}};var c=class{constructor(e,t={type:"To"}){o(this,"reSpecCompliantAddr",/(([^<>\r\n]+)\s)?<[^\r\n]+>/);o(this,"name","");o(this,"addr","");o(this,"type","To");this.type=t.type,this.parse(e);}getAddrDomain(){if(this.addr.includes("@")){let e=this.addr.split("@");if(e.length>1)return e[1]}return ""}dump(){return this.name.length>0?`"${this.name}" <${this.addr}>`:`<${this.addr}>`}parse(e){if(this.isMailboxAddrObject(e))return this.addr=e.addr,typeof e.name=="string"&&(this.name=e.name),typeof e.type=="string"&&(this.type=e.type),this;if(this.isMailboxAddrText(e)){let t=e.trim();if(t.startsWith("<")&&t.endsWith(">"))return this.addr=t.slice(1,-1),this;let r=t.split(" <");return r[0]=/^("|')/.test(r[0])?r[0].slice(1):r[0],r[0]=/("|')$/.test(r[0])?r[0].slice(0,-1):r[0],r[1]=r[1].slice(0,-1),this.name=r[0],this.addr=r[1],this}if(typeof e=="string")return this.addr=e,this;throw new l("MIMETEXT_INVALID_MAILBOX","Couldn't recognize the input.")}isMailboxAddrText(e){return typeof e=="string"&&this.reSpecCompliantAddr.test(e)}isMailboxAddrObject(e){return this.isObject(e)&&Object.hasOwn(e,"addr")}isObject(e){return !!e&&e.constructor===Object}};var x=class{constructor(e){o(this,"envctx");o(this,"fields",[{name:"Date",generator:()=>new Date().toUTCString().replace(/GMT|UTC/gi,"+0000")},{name:"From",required:!0,validate:e=>this.validateMailboxSingle(e),dump:e=>this.dumpMailboxSingle(e)},{name:"Sender",validate:e=>this.validateMailboxSingle(e),dump:e=>this.dumpMailboxSingle(e)},{name:"Reply-To",validate:e=>this.validateMailboxSingle(e),dump:e=>this.dumpMailboxSingle(e)},{name:"To",validate:e=>this.validateMailboxMulti(e),dump:e=>this.dumpMailboxMulti(e)},{name:"Cc",validate:e=>this.validateMailboxMulti(e),dump:e=>this.dumpMailboxMulti(e)},{name:"Bcc",validate:e=>this.validateMailboxMulti(e),dump:e=>this.dumpMailboxMulti(e)},{name:"Message-ID",generator:()=>{let e=Math.random().toString(36).slice(2),r=this.fields.filter(i=>i.name==="From")[0].value.getAddrDomain();return "<"+e+"@"+r+">"}},{name:"Subject",required:!0,dump:e=>typeof e=="string"?"=?utf-8?B?"+this.envctx.toBase64(e)+"?=":""},{name:"MIME-Version",generator:()=>"1.0"}]);this.envctx=e;}dump(){let e="";for(let t of this.fields){if(t.disabled)continue;let r=t.value!==void 0&&t.value!==null;if(!r&&t.required)throw new l("MIMETEXT_MISSING_HEADER",`The "${t.name}" header is required.`);if(!r&&typeof t.generator!="function")continue;!r&&typeof t.generator=="function"&&(t.value=t.generator());let i=Object.hasOwn(t,"dump")&&typeof t.dump=="function"?t.dump(t.value):typeof t.value=="string"?t.value:"";e+=`${t.name}: ${i}${this.envctx.eol}`;}return e.slice(0,-1*this.envctx.eol.length)}toObject(){return this.fields.reduce((e,t)=>(e[t.name]=t.value,e),{})}get(e){let t=i=>i.name.toLowerCase()===e.toLowerCase(),r=this.fields.findIndex(t);return r!==-1?this.fields[r].value:void 0}set(e,t){let r=s=>s.name.toLowerCase()===e.toLowerCase();if(!!this.fields.some(r)){let s=this.fields.findIndex(r),d=this.fields[s];if(d.validate&&!d.validate(t))throw new l("MIMETEXT_INVALID_HEADER_VALUE",`The value for the header "${e}" is invalid.`);return this.fields[s].value=t,this.fields[s]}return this.setCustom({name:e,value:t,custom:!0,dump:s=>typeof s=="string"?s:""})}setCustom(e){if(this.isHeaderField(e)){if(typeof e.value!="string")throw new l("MIMETEXT_INVALID_HEADER_FIELD","Custom header must have a value.");return this.fields.push(e),e}throw new l("MIMETEXT_INVALID_HEADER_FIELD","Invalid input for custom header. It must be in type of HeaderField.")}validateMailboxSingle(e){return e instanceof c}validateMailboxMulti(e){return e instanceof c||this.isArrayOfMailboxes(e)}dumpMailboxMulti(e){let t=r=>r.name.length===0?r.dump():`=?utf-8?B?${this.envctx.toBase64(r.name)}?= <${r.addr}>`;return this.isArrayOfMailboxes(e)?e.map(t).join(`,${this.envctx.eol} `):e instanceof c?t(e):""}dumpMailboxSingle(e){let t=r=>r.name.length===0?r.dump():`=?utf-8?B?${this.envctx.toBase64(r.name)}?= <${r.addr}>`;return e instanceof c?t(e):""}isHeaderField(e){let t=["name","value","dump","required","disabled","generator","custom"];if(this.isObject(e)){let r=e;if(Object.hasOwn(r,"name")&&typeof r.name=="string"&&r.name.length>0&&!Object.keys(r).some(i=>!t.includes(i)))return !0}return !1}isObject(e){return !!e&&e.constructor===Object}isArrayOfMailboxes(e){return this.isArray(e)&&e.every(t=>t instanceof c)}isArray(e){return !!e&&e.constructor===Array}},E=class extends x{constructor(t){super(t);o(this,"fields",[{name:"Content-ID"},{name:"Content-Type"},{name:"Content-Transfer-Encoding"},{name:"Content-Disposition"}]);}};var p=class{constructor(e,t,r={}){o(this,"envctx");o(this,"headers");o(this,"data");this.envctx=e,this.headers=new E(this.envctx),this.data=t,this.setHeaders(r);}dump(){let e=this.envctx.eol;return this.headers.dump()+e+e+this.data}isAttachment(){let e=this.headers.get("Content-Disposition");return typeof e=="string"&&e.includes("attachment")}isInlineAttachment(){let e=this.headers.get("Content-Disposition");return typeof e=="string"&&e.includes("inline")}setHeader(e,t){return this.headers.set(e,t),e}getHeader(e){return this.headers.get(e)}setHeaders(e){return Object.keys(e).map(t=>this.setHeader(t,e[t]))}getHeaders(){return this.headers.toObject()}};var M=class{constructor(e){o(this,"envctx");o(this,"headers");o(this,"boundaries",{mixed:"",alt:"",related:""});o(this,"validTypes",["text/html","text/plain"]);o(this,"validContentTransferEncodings",["7bit","8bit","binary","quoted-printable","base64"]);o(this,"messages",[]);this.envctx=e,this.headers=new x(this.envctx),this.messages=[],this.generateBoundaries();}asRaw(){let e=this.envctx.eol,t=this.headers.dump(),r=this.getMessageByType("text/plain"),i=this.getMessageByType("text/html"),s=i??r??void 0;if(s===void 0)throw new l("MIMETEXT_MISSING_BODY","No content added to the message.");let d=this.hasAttachments(),u=this.hasInlineAttachments(),y=u&&d?"mixed+related":d?"mixed":u?"related":r&&i?"alternative":"";if(y==="mixed+related"){let g=this.getAttachments().map(T=>"--"+this.boundaries.mixed+e+T.dump()+e+e).join("").slice(0,-1*e.length),m=this.getInlineAttachments().map(T=>"--"+this.boundaries.related+e+T.dump()+e+e).join("").slice(0,-1*e.length);return t+e+"Content-Type: multipart/mixed; boundary="+this.boundaries.mixed+e+e+"--"+this.boundaries.mixed+e+"Content-Type: multipart/related; boundary="+this.boundaries.related+e+e+this.dumpTextContent(r,i,this.boundaries.related)+e+e+m+"--"+this.boundaries.related+"--"+e+g+"--"+this.boundaries.mixed+"--"}else if(y==="mixed"){let g=this.getAttachments().map(m=>"--"+this.boundaries.mixed+e+m.dump()+e+e).join("").slice(0,-1*e.length);return t+e+"Content-Type: multipart/mixed; boundary="+this.boundaries.mixed+e+e+this.dumpTextContent(r,i,this.boundaries.mixed)+e+(r&&i?"":e)+g+"--"+this.boundaries.mixed+"--"}else if(y==="related"){let g=this.getInlineAttachments().map(m=>"--"+this.boundaries.related+e+m.dump()+e+e).join("").slice(0,-1*e.length);return t+e+"Content-Type: multipart/related; boundary="+this.boundaries.related+e+e+this.dumpTextContent(r,i,this.boundaries.related)+e+e+g+"--"+this.boundaries.related+"--"}else return y==="alternative"?t+e+"Content-Type: multipart/alternative; boundary="+this.boundaries.alt+e+e+this.dumpTextContent(r,i,this.boundaries.alt)+e+e+"--"+this.boundaries.alt+"--":t+e+s.dump()}asEncoded(){return this.envctx.toBase64WebSafe(this.asRaw())}dumpTextContent(e,t,r){let i=this.envctx.eol,s=t??e,d="";return e&&t&&!this.hasInlineAttachments()&&this.hasAttachments()?d="--"+r+i+"Content-Type: multipart/alternative; boundary="+this.boundaries.alt+i+i+"--"+this.boundaries.alt+i+e.dump()+i+i+"--"+this.boundaries.alt+i+t.dump()+i+i+"--"+this.boundaries.alt+"--":e&&t&&this.hasInlineAttachments()?d="--"+r+i+t.dump():e&&t?d="--"+r+i+e.dump()+i+i+"--"+r+i+t.dump():d="--"+r+i+s.dump(),d}hasInlineAttachments(){return this.messages.some(e=>e.isInlineAttachment())}hasAttachments(){return this.messages.some(e=>e.isAttachment())}getAttachments(){let e=t=>t.isAttachment();return this.messages.some(e)?this.messages.filter(e):[]}getInlineAttachments(){let e=t=>t.isInlineAttachment();return this.messages.some(e)?this.messages.filter(e):[]}getMessageByType(e){let t=r=>!r.isAttachment()&&!r.isInlineAttachment()&&(r.getHeader("Content-Type")||"").includes(e);return this.messages.some(t)?this.messages.filter(t)[0]:void 0}addAttachment(e){if(this.isObject(e.headers)||(e.headers={}),typeof e.filename!="string")throw new l("MIMETEXT_MISSING_FILENAME",'The property "filename" must exist while adding attachments.');let t=(e.headers["Content-Type"]??e.contentType)||"none";if(this.envctx.validateContentType(t)===!1)throw new l("MIMETEXT_INVALID_MESSAGE_TYPE",`You specified an invalid content type "${t}".`);let r=e.headers["Content-Transfer-Encoding"]??e.encoding??"base64";this.validContentTransferEncodings.includes(r)||(t="application/octet-stream");let i=e.headers["Content-ID"];typeof i=="string"&&i.length>2&&!i.startsWith("<")&&!i.endsWith(">")&&(e.headers["Content-ID"]="<"+e.headers["Content-ID"]+">");let s=e.inline?"inline":"attachment";return e.headers=Object.assign({},e.headers,{"Content-Type":`${t}; name="${e.filename}"`,"Content-Transfer-Encoding":r,"Content-Disposition":`${s}; filename="${e.filename}"`}),this._addMessage({data:e.data,headers:e.headers})}addMessage(e){this.isObject(e.headers)||(e.headers={});let t=(e.headers["Content-Type"]??e.contentType)||"none";if(!this.validTypes.includes(t))throw new l("MIMETEXT_INVALID_MESSAGE_TYPE",`Valid content types are ${this.validTypes.join(", ")} but you specified "${t}".`);let r=e.headers["Content-Transfer-Encoding"]??e.encoding??"7bit";this.validContentTransferEncodings.includes(r)||(t="application/octet-stream");let i=e.charset??"UTF-8";return e.headers=Object.assign({},e.headers,{"Content-Type":`${t}; charset=${i}`,"Content-Transfer-Encoding":r}),this._addMessage({data:e.data,headers:e.headers})}_addMessage(e){let t=new p(this.envctx,e.data,e.headers);return this.messages.push(t),t}setSender(e,t={type:"From"}){let r=new c(e,t);return this.setHeader("From",r),r}getSender(){return this.getHeader("From")}setRecipients(e,t={type:"To"}){let i=(this.isArray(e)?e:[e]).map(s=>new c(s,t));return this.setHeader(t.type,i),i}getRecipients(e={type:"To"}){return this.getHeader(e.type)}setRecipient(e,t={type:"To"}){return this.setRecipients(e,t)}setTo(e,t={type:"To"}){return this.setRecipients(e,t)}setCc(e,t={type:"Cc"}){return this.setRecipients(e,t)}setBcc(e,t={type:"Bcc"}){return this.setRecipients(e,t)}setSubject(e){return this.setHeader("subject",e),e}getSubject(){return this.getHeader("subject")}setHeader(e,t){return this.headers.set(e,t),e}getHeader(e){return this.headers.get(e)}setHeaders(e){return Object.keys(e).map(t=>this.setHeader(t,e[t]))}getHeaders(){return this.headers.toObject()}toBase64(e){return this.envctx.toBase64(e)}toBase64WebSafe(e){return this.envctx.toBase64WebSafe(e)}generateBoundaries(){this.boundaries={mixed:Math.random().toString(36).slice(2),alt:Math.random().toString(36).slice(2),related:Math.random().toString(36).slice(2)};}isArray(e){return !!e&&e.constructor===Array}isObject(e){return !!e&&e.constructor===Object}};var oe={toBase64:function(e){return O.encode(e)},toBase64WebSafe:function(e){return O.encodeURI(e)},eol:`\r
`,validateContentType:n=>n.length>0?n:!1};function Oe(){return new M(oe)}

	exports.MIMEMessage = M;
	exports.MIMEMessageContent = p;
	exports.MIMEMessageHeader = x;
	exports.MIMETextError = l;
	exports.Mailbox = c;
	exports.createMimeMessage = Oe;

	return exports;

})({});
//# sourceMappingURL=out.js.map
//# sourceMappingURL=browser.global.js.map